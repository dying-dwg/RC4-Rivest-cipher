# RC4
RC4 (от англ. Rivest cipher 4 или Ron’s code), также известен как ARC4 или ARCFOUR (alleged RC4) потоковый шифр, широко применяющийся в различных системах защиты информации в компьютерных сетях. <sup>[[wikipedia](https://ru.wikipedia.org/wiki/RC4)]</sup>

### Алгоритм шифрования

- Функция генерирует последовательность битов k<sub>i</sub>.
- Далее последовательность битов посредством операции суммирование по модулю два (xor) объединяется с открытым текстом (m<sub>i</sub>). В результате получается шифрограмма ( c<sub>i</sub> ): c<sub>i</sub> = m<sub>i</sub> ⨁ k<sub>i</sub>

### Алгоритм расшифровки

- Повторно создаётся (регенерируется) поток битов ключа (ключевой поток) k<sub>i</sub>.
- Поток битов ключа складывается с шифрограммой ( c<sub>i</sub> ) операцией «xor». В силу свойств операции «xor» на выходе получается исходный (незашифрованный) текст ( m<sub>i</sub> ): m<sub>i</sub> = c<sub>i</sub> ⨁ k<sub>i</sub> = ( m<sub>i</sub> ⨁ k<sub>i</sub> ) ⨁ k<sub>i</sub>

<p align="center"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/54/Gamma12.PNG/800px-Gamma12.PNG?20091107083054" width="550"></p>
<p align="center">Режим гаммирования для поточных шифров RC4</p>

### Инициализация RC4 состоит из двух частей:

- Инициализация S-блока (init_s_block)
    + Алгоритм также известен как «key-scheduling algorithm» или «KSA». Этот алгоритм использует ключ, подаваемый на вход пользователем, сохранённый в Key, и имеющий длину L байт. Инициализация начинается с заполнения массива S, далее этот массив перемешивается путём перестановок, определяемых ключом. Так как только одно действие выполняется над S, то должно выполняться утверждение, что S всегда содержит один набор значений, который был дан при первоначальной инициализации (s_box[i] := i).

- Генерация псевдослучайного слова K (K_XOR)
  + Эта часть алгоритма называется генератором псевдослучайной последовательности (англ. pseudo-random generation algorithm, PRGA). Генератор ключевого потока RC4 переставляет значения, хранящиеся в S. В одном цикле RC4 определяется одно n-битное слово K из ключевого потока. В дальнейшем ключевое слово будет сложено по модулю два с исходным текстом, которое пользователь хочет зашифровать, и получен зашифрованный текст.

<p align="center"><img src="https://user-images.githubusercontent.com/66872084/200085436-492bd064-4a47-4a3c-a9e3-d610e76e0761.png" width="550"></p>
<p align="center">Генератор ключевого потока RC4</p>
